{% extends 'Backend/Master/Base.twig' %}

{% block title %}{{ NAME }} - {{ TITLE }}{% endblock %}

{% block head %}

    {{ parent() }}

    <link rel="stylesheet" href="{{ GLOBAL_COMPONENTS }}datatables/media/css/dataTables.bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="{{ GLOBAL_COMPONENTS }}chosen/chosen.min.css" type="text/css" />

{% endblock %}

{% block content %}

    <div id="page-wrapper">

        <div class="container{% if CONTENT_FLUID %}-fluid{% endif %}">

                <!-- Page Heading -->
                <div class="row">
                    <div class="col-lg-12">
                        <h1 class="page-header">

                        </h1>
                        <ol class="breadcrumb">
                            <li>
                                <i class="fa fa-dashboard"></i>  <a href="{{ urlFor( 'dashboard' ) }}">Dashboard</a>
                            </li>
                            <li class="active">
                                <i class="fa fa-envelope-o"></i> Mail Box
                            </li>
                        </ol>
                    </div>
                </div>
                <!-- /.row -->

            <!-- /.row -->
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        {% if PROVIDER == 'DEFAULT' %}
                        <div class="panel-heading">
                            <div class="panel-heading">
                                <a href="#" role="button" class="btn btn-primary" data-toggle="modal" data-target="#composeMessages" rel="tooltip" data-placement="right" title=""><i class="fa fa-paper-plane-o"></i> Compose New Message</a>
                            </div>
                        </div>
                        {% endif %}
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs"> <!-- Nav tabs/pills -->
                                <li class="active"><a href="#inbox" data-toggle="tab">Inbox</a></li>
                                {% if PROVIDER == 'DEFAULT' %}
                                    <li><a href="#outbox" data-toggle="tab">Outbox</a></li>
                                {% endif %}
                                <li><a href="#archived" data-toggle="tab">Archived</a></li>
                            </ul>
                            <div class="tab-content">

                                <div class="tab-pane fade in active" id="inbox">

                                    <br />

                                    <div class="panel panel-default">

                                        <div class="panel-body">
                                            <div class="dataTable_wrapper">
                                                <table class="table table-striped table-bordered table-hover" id="all-inbox">

                                                    <thead>
                                                    <tr>
                                                        <th>Sender</th>
                                                        <th class="cbn-table-center">Date</th>
                                                        <th class="cbn-table-center">Status</th>
                                                        <th>Title</th>
                                                        <th>Messages</th>
                                                        <th class="cbn-table-center">Last Update Date</th>
                                                        <th class="cbn-table-center">Action</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% if ALL_USER_INBOX_MESSAGE|length > 0 %}
                                                        {% for mail in ALL_USER_INBOX_MESSAGE %}

                                                            <tr>
                                                                <td><a href="{{ urlFor( 'users' ) }}{{ mail.user_id|e }}">{{ mail.user_name|e }}{% if not mail.user_name %}<span class="label label-danger">User was Deleted</span>{% endif %}</a> </td>
                                                                <td class="cbn-table-center">
                                                                    <span class="label label-default">{{ mail.sent_date }}</span>
                                                                </td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.is_read == '0' %}
                                                                        <span class="label label-danger">Unread</span>
                                                                    {% else %}
                                                                        <span class="label label-success">Read</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td>{{ mail.mail_title }}</td>
                                                                <td>{{ mail.mail_content }}</td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.last_updated_date == '0000-00-00 00:00:00' %}
                                                                        <span class="label label-danger">Not updated</span>
                                                                    {% else %}
                                                                    <span class="label label-default">{{ mail.last_updated_date }}</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.is_read == '0' %}
                                                                        <a href="#" role="button" class="btn btn-success" data-toggle="modal" data-target="#markAsRead{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Mark as Read"><i class="fa fa-check-square-o"></i></a>
                                                                    {% else %}
                                                                        <a href="#" role="button" class="btn btn-warning" data-toggle="modal" data-target="#markAsUnread{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Mark as Un-Read"><i class="fa fa-exclamation-circle"></i></a>
                                                                        {% if mail.is_archived == '0' %}
                                                                            <a href="#" role="button" class="btn btn-primary" data-toggle="modal" data-target="#markAsArchived{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Mark as Archived"><i class="fa fa-briefcase"></i></a>
                                                                        {% endif %}
                                                                    {% endif %}

                                                                    <a href="#" role="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteMailByReceiver{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Delete Message"><i class="fa fa-ban"></i></a>
                                                                </td>
                                                            </tr>

                                                            {% if mail.is_read == '0' %}
                                                                <!-- Mark as Read Mail Modal -->
                                                                <div class="modal fade" id="markAsRead{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                                <h4 class="modal-title" id="myModalLabel">Mark as Read Message from : {{ mail.user_name|e }}</h4>
                                                                            </div>

                                                                            <form action="{{ urlFor( 'markAsRead' ) }}" method="post" role="form">
                                                                                <div class="modal-body">

                                                                                    <div class="form-group">
                                                                                        <h5>Are you sure ?</h5>
                                                                                    </div>

                                                                                    <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                                </div>
                                                                                <div class="modal-footer">

                                                                                    <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                    <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                                </div>

                                                                                <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                            </form>

                                                                        </div>
                                                                        <!-- /.modal-content -->
                                                                    </div>
                                                                    <!-- /.modal-dialog -->
                                                                </div>
                                                                <!-- /.modal -->
                                                            {% else %}
                                                                <!-- Mark as Unread Mail Modal -->
                                                                <div class="modal fade" id="markAsUnread{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                                <h4 class="modal-title" id="myModalLabel">Mark as Unread Message from : {{ mail.user_name|e }}</h4>
                                                                            </div>

                                                                            <form action="{{ urlFor( 'markAsUnread' ) }}" method="post" role="form">
                                                                                <div class="modal-body">

                                                                                    <div class="form-group">
                                                                                        <h5>Are you sure ?</h5>
                                                                                    </div>

                                                                                    <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                                </div>
                                                                                <div class="modal-footer">

                                                                                    <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                    <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                                </div>

                                                                                <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                            </form>

                                                                        </div>
                                                                        <!-- /.modal-content -->
                                                                    </div>
                                                                    <!-- /.modal-dialog -->
                                                                </div>
                                                                <!-- /.modal -->
                                                                {% if mail.is_archived == '0' %}
                                                                    <!-- Mark as Archived Mail Modal -->
                                                                    <div class="modal fade" id="markAsArchived{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                        <div class="modal-dialog">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                                    <h4 class="modal-title" id="myModalLabel">Mark as Archived Message from : {{ mail.user_name|e }}</h4>
                                                                                </div>

                                                                                <form action="{{ urlFor( 'markAsArchived' ) }}" method="post" role="form">
                                                                                    <div class="modal-body">

                                                                                        <div class="form-group">
                                                                                            <h5>Are you sure ?</h5>
                                                                                        </div>

                                                                                        <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                                    </div>
                                                                                    <div class="modal-footer">

                                                                                        <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                        <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                                    </div>

                                                                                    <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                                </form>

                                                                            </div>
                                                                            <!-- /.modal-content -->
                                                                        </div>
                                                                        <!-- /.modal-dialog -->
                                                                    </div>
                                                                    <!-- /.modal -->
                                                                {% endif %}
                                                            {% endif %}

                                                            <!-- Delete Mail Modal -->
                                                            <div class="modal fade" id="deleteMailByReceiver{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                <div class="modal-dialog">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                            <h4 class="modal-title" id="myModalLabel">Delete Message from : {{ mail.user_name|e }}</h4>
                                                                        </div>

                                                                        <form action="{{ urlFor( 'deleteMailByReceiver' ) }}" method="post" role="form">
                                                                            <div class="modal-body">

                                                                                <div class="form-group">
                                                                                    <h5>Are you sure want to delete this message ?</h5>
                                                                                </div>

                                                                                <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                            </div>
                                                                            <div class="modal-footer">

                                                                                <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                            </div>

                                                                            <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                        </form>

                                                                    </div>
                                                                    <!-- /.modal-content -->
                                                                </div>
                                                                <!-- /.modal-dialog -->
                                                            </div>
                                                            <!-- /.modal -->

                                                        {% endfor %}
                                                    {% endif %}
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                        <!-- /.panel-body -->
                                    </div>
                                    <!-- /.panel -->

                                </div>

                                {% if PROVIDER == 'DEFAULT' %}

                                <div class="tab-pane fade in" id="outbox">

                                    <br />

                                    <div class="panel panel-default">

                                        <div class="panel-body">
                                            <div class="dataTable_wrapper">
                                                <table class="table table-striped table-bordered table-hover" id="all-outbox">

                                                    <thead>
                                                    <tr>
                                                        <th>Receiver</th>
                                                        <th class="cbn-table-center">Date</th>
                                                        <th class="cbn-table-center">Status</th>
                                                        <th>Title</th>
                                                        <th>Messages</th>
                                                        <th class="cbn-table-center">Last Update Date</th>
                                                        <th class="cbn-table-center">Action</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% if ALL_USER_OUTBOX_MESSAGE|length > 0 %}
                                                        {% for mail in ALL_USER_OUTBOX_MESSAGE %}

                                                            <tr>
                                                                <td><a href="{{ urlFor( 'users' ) }}{{ mail.user_id|e }}">{{ mail.user_name|e }}</a> </td>
                                                                <td class="cbn-table-center">
                                                                    <span class="label label-default">{{ mail.sent_date }}</span>
                                                                </td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.is_read == '0' %}
                                                                        <span class="label label-danger">Unread</span>
                                                                    {% else %}
                                                                        <span class="label label-success">Read</span>
                                                                    {% endif %}
                                                                    {% if mail.is_archived == '1' %}
                                                                        <span class="label label-primary">Archived</span>
                                                                    {% endif %}
                                                                    {% if mail.is_deleted == '1' %}
                                                                        <span class="label label-danger">Deleted</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td>{{ mail.mail_title }}</td>
                                                                <td>{{ mail.mail_content }}</td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.last_updated_date == '0000-00-00 00:00:00' %}
                                                                        <span class="label label-danger">Not updated</span>
                                                                    {% else %}
                                                                        <span class="label label-default">{{ mail.last_updated_date }}</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td class="cbn-table-center">

                                                                    {% if mail.is_read == '1' and mail.is_deleted == '1' %}
                                                                        <a href="#" role="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteMailBySender{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Delete Message"><i class="fa fa-ban"></i></a>
                                                                    {% else %}
                                                                        <span class="label label-default">---</span>
                                                                    {% endif %}

                                                                </td>
                                                            </tr>

                                                            <!-- Delete Mail Modal -->
                                                            <div class="modal fade" id="deleteMailBySender{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                <div class="modal-dialog">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                            <h4 class="modal-title" id="myModalLabel">Delete Message to : {{ mail.user_name|e }}</h4>
                                                                        </div>

                                                                        <form action="{{ urlFor( 'deleteMailBySender' ) }}" method="post" role="form">
                                                                            <div class="modal-body">

                                                                                <div class="form-group">
                                                                                    <h5>Are you sure want to delete this message ?</h5>
                                                                                </div>

                                                                                <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                            </div>
                                                                            <div class="modal-footer">

                                                                                <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                            </div>

                                                                            <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                        </form>

                                                                    </div>
                                                                    <!-- /.modal-content -->
                                                                </div>
                                                                <!-- /.modal-dialog -->
                                                            </div>
                                                            <!-- /.modal -->

                                                        {% endfor %}
                                                    {% endif %}
                                                    </tbody>

                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                        <!-- /.panel-body -->
                                    </div>
                                    <!-- /.panel -->

                                </div>

                                {% endif %}

                                <div class="tab-pane fade in" id="archived">

                                    <br />

                                    <div class="panel panel-default">

                                        <div class="panel-body">
                                            <div class="dataTable_wrapper">
                                                <table class="table table-striped table-bordered table-hover" id="all-archived">

                                                    <thead>
                                                    <tr>
                                                        <th>Sender</th>
                                                        <th class="cbn-table-center">Date</th>
                                                        <th class="cbn-table-center">Status</th>
                                                        <th>Title</th>
                                                        <th>Messages</th>
                                                        <th class="cbn-table-center">Last Update Date</th>
                                                        <th class="cbn-table-center">Action</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% if ALL_USER_ARCHIVED_MESSAGE|length > 0 %}
                                                        {% for mail in ALL_USER_ARCHIVED_MESSAGE %}

                                                            <tr>
                                                                <td><a href="{{ urlFor( 'users' ) }}{{ mail.user_id|e }}">{{ mail.user_name|e }}</a> </td>
                                                                <td class="cbn-table-center">
                                                                    <span class="label label-default">{{ mail.sent_date }}</span>
                                                                </td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.is_read == '0' %}
                                                                        <span class="label label-danger">Unread</span>
                                                                    {% else %}
                                                                        <span class="label label-success">Read</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td>{{ mail.mail_title }}</td>
                                                                <td>{{ mail.mail_content }}</td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.last_updated_date == '0000-00-00 00:00:00' %}
                                                                        <span class="label label-danger">Not updated</span>
                                                                    {% else %}
                                                                        <span class="label label-default">{{ mail.last_updated_date }}</span>
                                                                    {% endif %}
                                                                </td>
                                                                <td class="cbn-table-center">
                                                                    {% if mail.is_archived == '1' %}
                                                                        <a href="#" role="button" class="btn btn-warning" data-toggle="modal" data-target="#markAsUnarchived{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Mark as Un-Archived"><i class="fa fa-briefcase"></i></a>
                                                                    {% endif %}
                                                                    <a href="#" role="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteMailByReceiver{{ mail.mailbox_id|e }}" rel="tooltip" data-placement="top" title="Delete Message"><i class="fa fa-ban"></i></a>
                                                                </td>
                                                            </tr>

                                                            {% if mail.is_archived == '1' %}
                                                                <!-- Mark as Unarchived Mail Modal -->
                                                                <div class="modal fade" id="markAsUnarchived{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                    <div class="modal-dialog">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                                <h4 class="modal-title" id="myModalLabel">Mark as Un-Archived Message from : {{ mail.user_name|e }}</h4>
                                                                            </div>

                                                                            <form action="{{ urlFor( 'markAsUnarchived' ) }}" method="post" role="form">
                                                                                <div class="modal-body">

                                                                                    <div class="form-group">
                                                                                        <h5>Are you sure ?</h5>
                                                                                    </div>

                                                                                    <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                                </div>
                                                                                <div class="modal-footer">

                                                                                    <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                    <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                                </div>

                                                                                <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                            </form>

                                                                        </div>
                                                                        <!-- /.modal-content -->
                                                                    </div>
                                                                    <!-- /.modal-dialog -->
                                                                </div>
                                                                <!-- /.modal -->
                                                            {% endif %}

                                                            <!-- Delete Mail Modal -->
                                                            <div class="modal fade" id="deleteMailByReceiver{{ mail.mailbox_id|e }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                                                <div class="modal-dialog">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <a class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
                                                                            <h4 class="modal-title" id="myModalLabel">Delete Message from : {{ mail.user_name|e }}</h4>
                                                                        </div>

                                                                        <form action="{{ urlFor( 'deleteMailByReceiver' ) }}" method="post" role="form">
                                                                            <div class="modal-body">

                                                                                <div class="form-group">
                                                                                    <h5>Are you sure want to delete this message ?</h5>
                                                                                </div>

                                                                                <input type="hidden" name="mailbox_id" value="{{ mail.mailbox_id|e }}">

                                                                            </div>
                                                                            <div class="modal-footer">

                                                                                <a class="btn btn-danger" data-dismiss="modal">No</a>
                                                                                <button type="submit" class="btn btn-success pull-left">Yes</button>

                                                                            </div>

                                                                            <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                                                                        </form>

                                                                    </div>
                                                                    <!-- /.modal-content -->
                                                                </div>
                                                                <!-- /.modal-dialog -->
                                                            </div>
                                                            <!-- /.modal -->

                                                        {% endfor %}
                                                    {% endif %}
                                                    </tbody>

                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                        <!-- /.panel-body -->
                                    </div>
                                    <!-- /.panel -->

                                </div>

                            </div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>

            {% if PROVIDER == 'DEFAULT' %}
                <!-- COMPOSE MESSAGE MODAL -->
                <div class="modal fade" id="composeMessages" tabindex="-1" role="dialog" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                <h4 class="modal-title"><i class="fa fa-paper-plane-o"></i> Compose New Messages</h4>
                            </div>
                            <form role="form" method="post" action="{{ urlFor( 'composeMessage' ) }}">
                                <div class="modal-body">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <span class="input-group-addon">TO:</span>
                                            {% if ALL_USERS|length > 0 %}
                                                <label for="receiver_id"></label>
                                                <select data-placeholder="Select User Recipient" name="receiver_id[]" id="receiver_id" class="form-control chosen-select" multiple tabindex="4" >
                                                {% for user in ALL_USERS %}
                                                    <option value="{{ user.user_id }}">{{ user.user_name }}  - {{ user.role_name }}</option>
                                                {% endfor %}
                                            </select>
                                            {% else %}
                                            <select name="receiver_id[]" id="receiver_id" class="form-control" disabled>
                                                <option value="" selected>There is currently no User Data !</option>
                                            </select>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="input-group">
                                            <span class="input-group-addon">Subject:</span>
                                            <input name="mail_title" id="mail_title" type="text" class="form-control" placeholder=" Mail Title" value="" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <textarea name="mail_content" id="mail_content" class="form-control" placeholder="Mail Content" style="height: 120px;" required></textarea>
                                    </div>

                                    <input type="hidden" name="sender_id" value="{{ ID }}">
                                </div>
                                <div class="modal-footer clearfix">

                                    <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Discard</button>

                                    <button type='submit' value='Compose' class='btn btn-success pull-left'><i class="fa fa-paper-plane-o"></i> Compose Message</button>
                                </div>

                                <input type="hidden" name="{{ CSRF_TOKEN_NAME }}" value="{{ CSRF_TOKEN_VALUE }}"/>

                            </form>
                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal -->
            {% endif %}

        </div><!-- /.container-fluid -->

    </div><!-- /#page-wrapper -->
{% endblock %}

{% block footer %}
    {{ parent() }}

    {{  SCRIPT|raw }}

    <script type="text/javascript">

        $('.row').tooltip({
            selector: "[rel=tooltip]",
            container: "body"
        })

    </script>

    <script src="{{ GLOBAL_COMPONENTS }}datatables/media/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="{{ GLOBAL_COMPONENTS }}datatables/media/js/dataTables.bootstrap.min.js" type="text/javascript"></script>
    <script src="{{ GLOBAL_COMPONENTS }}chosen/chosen.jquery.min.js" type="text/javascript"></script>
    <script>
        var config = {
            '.chosen-select'           : {},
            '.chosen-select-deselect'  : {allow_single_deselect:true},
            '.chosen-select-no-single' : {disable_search_threshold:10},
            '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
            '.chosen-select-width'     : {width:"100%"}
        };
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }
        $(document).ready(function() {
            $('#all-inbox').DataTable({
                "responsive": true,
                "stateSave": true,
                "columnDefs": [
                    { "searchable": false, "sortable": false, "targets": 2 },
                    { "searchable": false, "sortable": false, "targets": 6 }
                ]
            });
            $('#all-outbox').DataTable({
                "responsive": true,
                "stateSave": true,
                "columnDefs": [
                    { "searchable": false, "sortable": false, "targets": 2 },
                    { "searchable": false, "sortable": false, "targets": 6 }
                ]
            });
            $('#all-archived').DataTable({
                "responsive": true,
                "stateSave": true,
                "columnDefs": [
                    { "searchable": false, "sortable": false, "targets": 2 },
                    { "searchable": false, "sortable": false, "targets": 6 }
                ]
            });
        });
    </script>
    <script src="{{ GLOBAL_COMPONENTS }}gritter/js/jquery.gritter.min.js" type="text/javascript"></script>
    {% if errors %}
        <script>
            $.gritter.add({
                // (string | mandatory) the heading of the notification
                title: '<i class="fa fa-meh-o"></i> Something went wrong !',
                // (string | mandatory) the text inside the notification
                text: "<i>{{ errors }}</i>",
                class_name: 'gritter-alert gritter-icon'
            });
        </script>
    {% endif %}

    {% if flash.error %}

        <script>
            $.gritter.add({
                // (string | mandatory) the heading of the notification
                title: '<i class="fa fa-meh-o"></i> Something went wrong !',
                // (string | mandatory) the text inside the notification
                text: "<i>{{ flash.error }}</i>",
                class_name: 'gritter-alert gritter-icon'
            });
        </script>

    {% endif %}

    {% if flash.info %}

        <script>
            $.gritter.add({
                // (string | mandatory) the heading of the notification
                title: '<i class="fa fa-smile-o"></i> Information !',
                // (string | mandatory) the text inside the notification
                text: "<i>{{ flash.info }}</i>",
                class_name: 'gritter-facebook gritter-icon'
            });
        </script>

    {% endif %}

    {% if flash.success %}

        <script>
            $.gritter.add({
                // (string | mandatory) the heading of the notification
                title: '<i class="fa fa-smile-o"></i> Congratulations !',
                // (string | mandatory) the text inside the notification
                text: "<i>{{ flash.success }}</i>",
                class_name: 'gritter-success gritter-icon'
            });
        </script>

    {% endif %}

{% endblock %}
